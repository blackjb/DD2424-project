/usr/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
trainingset size: 100000
validationset size: 10000
input_dims:  (64, 64, 3)
nb_labels:  200
nb_labels: 200
x_train.shape  (100000, 64, 64, 3)
y_train.shape  (100000, 200)
x_test.shape  (10000, 64, 64, 3)
y_test.shape  (10000, 200)
/home/sisten/code/python/DD2424-project/models.py:51: UserWarning: Update your `Conv2D` call to the Keras 2 API: `Conv2D(48, (7, 3), input_shape=(64, 64, 3...)`
  model.add(layers.Convolution2D(48, 7, 3, input_shape=input_dims))
/home/sisten/code/python/DD2424-project/models.py:57: UserWarning: Update your `Conv2D` call to the Keras 2 API: `Conv2D(128, (5, 1))`
  model.add(layers.Convolution2D(128, 5, 1))
/home/sisten/code/python/DD2424-project/models.py:63: UserWarning: Update your `Conv2D` call to the Keras 2 API: `Conv2D(192, (3, 1))`
  model.add(layers.Convolution2D(192, 3, 1))
/home/sisten/code/python/DD2424-project/models.py:65: UserWarning: Update your `Conv2D` call to the Keras 2 API: `Conv2D(192, (3, 1))`
  model.add(layers.Convolution2D(192, 3, 1))
/home/sisten/code/python/DD2424-project/models.py:67: UserWarning: Update your `Conv2D` call to the Keras 2 API: `Conv2D(128, (3, 1))`
  model.add(layers.Convolution2D(128, 3, 1))
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 58, 62, 48)        3072      
_________________________________________________________________
activation_1 (Activation)    (None, 58, 62, 48)        0         
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 28, 30, 48)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 30, 128)       30848     
_________________________________________________________________
activation_2 (Activation)    (None, 24, 30, 128)       0         
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 11, 14, 128)       0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 9, 14, 192)        73920     
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 7, 14, 192)        110784    
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 5, 14, 128)        73856     
_________________________________________________________________
activation_3 (Activation)    (None, 5, 14, 128)        0         
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 2, 6, 128)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 1536)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 2048)              3147776   
_________________________________________________________________
dense_2 (Dense)              (None, 2048)              4196352   
_________________________________________________________________
dense_3 (Dense)              (None, 200)               409800    
=================================================================
Total params: 8,046,408
Trainable params: 8,046,408
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 - 90s - loss: 5.0575 - acc: 0.0187 - val_loss: 4.8656 - val_acc: 0.0333
Epoch 2/20
 - 33s - loss: 4.7644 - acc: 0.0441 - val_loss: 4.6786 - val_acc: 0.0556
Epoch 3/20
 - 33s - loss: 4.6353 - acc: 0.0584 - val_loss: 4.6222 - val_acc: 0.0598
Epoch 4/20
 - 33s - loss: 4.5354 - acc: 0.0695 - val_loss: 4.5673 - val_acc: 0.0648
Epoch 5/20
 - 33s - loss: 4.4220 - acc: 0.0813 - val_loss: 4.4244 - val_acc: 0.0827
Epoch 6/20
 - 33s - loss: 4.3244 - acc: 0.0938 - val_loss: 4.3882 - val_acc: 0.0872
Epoch 7/20
 - 33s - loss: 4.2499 - acc: 0.1024 - val_loss: 4.3565 - val_acc: 0.0909
Epoch 8/20
 - 33s - loss: 4.1916 - acc: 0.1092 - val_loss: 4.3536 - val_acc: 0.0981
Epoch 9/20
 - 33s - loss: 4.1361 - acc: 0.1147 - val_loss: 4.2983 - val_acc: 0.1015
Epoch 10/20
 - 33s - loss: 4.0800 - acc: 0.1222 - val_loss: 4.2883 - val_acc: 0.1076
Epoch 11/20
 - 33s - loss: 4.0265 - acc: 0.1294 - val_loss: 4.2831 - val_acc: 0.1085
Epoch 12/20
 - 33s - loss: 3.9669 - acc: 0.1362 - val_loss: 4.2815 - val_acc: 0.1098
Epoch 13/20
 - 33s - loss: 3.9002 - acc: 0.1456 - val_loss: 4.2747 - val_acc: 0.1117
Epoch 14/20
 - 33s - loss: 3.8361 - acc: 0.1551 - val_loss: 4.3553 - val_acc: 0.1056
Epoch 15/20
 - 33s - loss: 3.7714 - acc: 0.1649 - val_loss: 4.2919 - val_acc: 0.1145
Epoch 16/20
 - 33s - loss: 3.7092 - acc: 0.1740 - val_loss: 4.2920 - val_acc: 0.1150
Epoch 17/20
 - 33s - loss: 3.6453 - acc: 0.1824 - val_loss: 4.3972 - val_acc: 0.1151
Epoch 18/20
 - 33s - loss: 3.5847 - acc: 0.1906 - val_loss: 4.3510 - val_acc: 0.1168
Epoch 19/20
 - 33s - loss: 3.5132 - acc: 0.2040 - val_loss: 4.4371 - val_acc: 0.1132
Epoch 20/20
 - 33s - loss: 3.4508 - acc: 0.2133 - val_loss: 4.4297 - val_acc: 0.1194
training history:
{'val_loss': [4.8655650390625, 4.678643620300293, 4.622226010131836, 4.567252577209473, 4.424446439361573, 4.388181510925293, 4.356528903961181, 4.353585704040527, 4.2983297317504885, 4.2883383163452145, 4.283086722564697, 4.281505787658691, 4.2747203018188475, 4.3552952423095705, 4.29194736328125, 4.291998394775391, 4.397160381317138, 4.350976504516602, 4.437058657073974, 4.429663606262207], 'val_acc': [0.0333, 0.0556, 0.0598, 0.0648, 0.0827, 0.0872, 0.0909, 0.0981, 0.1015, 0.1076, 0.1085, 0.1098, 0.1117, 0.1056, 0.1145, 0.115, 0.1151, 0.1168, 0.1132, 0.1194], 'loss': [5.057454712219238, 4.76447257522583, 4.635294950714111, 4.535329405517578, 4.4220091465759275, 4.324441378326416, 4.249857293548584, 4.191534615478516, 4.136004247741699, 4.079929918670654, 4.026620752105713, 3.966932919921875, 3.900349996032715, 3.836179481048584, 3.771387986450195, 3.709151167678833, 3.6452766844177247, 3.584712159729004, 3.5131850720214843, 3.4506653646850585], 'acc': [0.01874, 0.04413, 0.05841, 0.06953, 0.0813, 0.09381, 0.10237, 0.10917, 0.11465, 0.12216, 0.12939, 0.13623, 0.14559, 0.15515, 0.16495, 0.17401, 0.1824, 0.19058, 0.20401, 0.2133]}
Training time: 
729.9319808483124
Evaluation results:  [4.4296635734558105, 0.1194]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_6 (Conv2D)            (None, 58, 62, 48)        3072      
_________________________________________________________________
activation_4 (Activation)    (None, 58, 62, 48)        0         
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 28, 30, 48)        0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 24, 30, 128)       30848     
_________________________________________________________________
activation_5 (Activation)    (None, 24, 30, 128)       0         
_________________________________________________________________
max_pooling2d_5 (MaxPooling2 (None, 11, 14, 128)       0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 9, 14, 192)        73920     
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 7, 14, 192)        110784    
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 5, 14, 128)        73856     
_________________________________________________________________
activation_6 (Activation)    (None, 5, 14, 128)        0         
_________________________________________________________________
max_pooling2d_6 (MaxPooling2 (None, 2, 6, 128)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 1536)              0         
_________________________________________________________________
dense_4 (Dense)              (None, 2048)              3147776   
_________________________________________________________________
dense_5 (Dense)              (None, 2048)              4196352   
_________________________________________________________________
dense_6 (Dense)              (None, 200)               409800    
=================================================================
Total params: 8,046,408
Trainable params: 8,046,408
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 - 34s - loss: 5.3122 - acc: 0.0046 - val_loss: 5.3006 - val_acc: 0.0050
Epoch 2/20
 - 33s - loss: 5.3022 - acc: 0.0046 - val_loss: 5.3014 - val_acc: 0.0050
Epoch 3/20
 - 33s - loss: 5.3026 - acc: 0.0046 - val_loss: 5.2998 - val_acc: 0.0050
Epoch 4/20
 - 34s - loss: 5.3023 - acc: 0.0044 - val_loss: 5.3002 - val_acc: 0.0050
Epoch 5/20
 - 34s - loss: 5.3020 - acc: 0.0047 - val_loss: 5.3000 - val_acc: 0.0050
Epoch 6/20
 - 34s - loss: 5.3018 - acc: 0.0044 - val_loss: 5.3000 - val_acc: 0.0050
Epoch 7/20
 - 34s - loss: 5.3019 - acc: 0.0047 - val_loss: 5.3000 - val_acc: 0.0050
Epoch 8/20
 - 34s - loss: 5.3019 - acc: 0.0042 - val_loss: 5.2998 - val_acc: 0.0050
Epoch 9/20
 - 34s - loss: 5.3019 - acc: 0.0047 - val_loss: 5.2997 - val_acc: 0.0050
Epoch 10/20
 - 34s - loss: 5.3014 - acc: 0.0051 - val_loss: 5.2997 - val_acc: 0.0050
Epoch 11/20
 - 34s - loss: 5.3013 - acc: 0.0047 - val_loss: 5.2996 - val_acc: 0.0050
Epoch 12/20
 - 34s - loss: 5.3012 - acc: 0.0046 - val_loss: 5.2995 - val_acc: 0.0050
Epoch 13/20
 - 34s - loss: 5.3014 - acc: 0.0044 - val_loss: 5.2996 - val_acc: 0.0050
Epoch 14/20
 - 34s - loss: 5.3014 - acc: 0.0047 - val_loss: 5.2996 - val_acc: 0.0050
Epoch 15/20
 - 34s - loss: 5.3014 - acc: 0.0046 - val_loss: 5.2996 - val_acc: 0.0050
Epoch 16/20
 - 34s - loss: 5.3012 - acc: 0.0047 - val_loss: 5.2997 - val_acc: 0.0050
Epoch 17/20
 - 34s - loss: 5.3012 - acc: 0.0048 - val_loss: 5.2995 - val_acc: 0.0050
Epoch 18/20
 - 34s - loss: 5.3013 - acc: 0.0045 - val_loss: 5.2994 - val_acc: 0.0050
Epoch 19/20
 - 34s - loss: 5.3013 - acc: 0.0042 - val_loss: 5.2993 - val_acc: 0.0050
Epoch 20/20
 - 34s - loss: 5.3013 - acc: 0.0046 - val_loss: 5.2994 - val_acc: 0.0050
training history:
{'val_loss': [5.300590399169922, 5.301376667785645, 5.2997659439086915, 5.300212841033936, 5.300014769744873, 5.299998308563232, 5.299982095336914, 5.299778321838379, 5.299704092407227, 5.299713832092285, 5.299555216217041, 5.2994591331481935, 5.299565956115723, 5.299560394287109, 5.299550340270996, 5.2997030143737796, 5.299549700927734, 5.299426787567139, 5.299344526672363, 5.299402400207519], 'val_acc': [0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005, 0.005], 'loss': [5.3122377473449705, 5.302196425476074, 5.302580791320801, 5.3022586045837405, 5.302037130737305, 5.301779352416992, 5.301902547607422, 5.301882360687256, 5.3018854475402835, 5.301420910186768, 5.301332227783203, 5.30121574295044, 5.3013771887207035, 5.301379152526856, 5.301372520446777, 5.301165597381591, 5.301161147766114, 5.301272998962403, 5.301340987091065, 5.301261587524414], 'acc': [0.00455, 0.00463, 0.0046, 0.00437, 0.00466, 0.00439, 0.00472, 0.00422, 0.00473, 0.00513, 0.00472, 0.00457, 0.00436, 0.00473, 0.00465, 0.00473, 0.0048, 0.00454, 0.00418, 0.00464]}
Training time: 
672.9867670536041
Evaluation results:  [5.299402416229248, 0.005]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_11 (Conv2D)           (None, 58, 62, 48)        3072      
_________________________________________________________________
activation_7 (Activation)    (None, 58, 62, 48)        0         
_________________________________________________________________
max_pooling2d_7 (MaxPooling2 (None, 28, 30, 48)        0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 24, 30, 128)       30848     
_________________________________________________________________
activation_8 (Activation)    (None, 24, 30, 128)       0         
_________________________________________________________________
max_pooling2d_8 (MaxPooling2 (None, 11, 14, 128)       0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 9, 14, 192)        73920     
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 7, 14, 192)        110784    
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 5, 14, 128)        73856     
_________________________________________________________________
activation_9 (Activation)    (None, 5, 14, 128)        0         
_________________________________________________________________
max_pooling2d_9 (MaxPooling2 (None, 2, 6, 128)         0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 1536)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 2048)              3147776   
_________________________________________________________________
dense_8 (Dense)              (None, 2048)              4196352   
_________________________________________________________________
dense_9 (Dense)              (None, 200)               409800    
=================================================================
Total params: 8,046,408
Trainable params: 8,046,408
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 - 34s - loss: 5.7536 - acc: 0.0227 - val_loss: 5.4792 - val_acc: 0.0330
Epoch 2/20
 - 34s - loss: 5.5811 - acc: 0.0320 - val_loss: 5.5580 - val_acc: 0.0319
Epoch 3/20
 - 34s - loss: 5.6705 - acc: 0.0275 - val_loss: 5.6280 - val_acc: 0.0233
Epoch 4/20
 - 34s - loss: 5.8073 - acc: 0.0205 - val_loss: 5.6799 - val_acc: 0.0188
Epoch 5/20
 - 34s - loss: 5.8513 - acc: 0.0174 - val_loss: 5.7672 - val_acc: 0.0228
Epoch 6/20
 - 34s - loss: 5.8992 - acc: 0.0133 - val_loss: 5.8114 - val_acc: 0.0136
Epoch 7/20
 - 34s - loss: 5.9044 - acc: 0.0154 - val_loss: 5.8717 - val_acc: 0.0183
Epoch 8/20
 - 34s - loss: 5.9287 - acc: 0.0142 - val_loss: 5.9796 - val_acc: 0.0093
Epoch 9/20
 - 34s - loss: 5.8960 - acc: 0.0137 - val_loss: 5.8090 - val_acc: 0.0126
Epoch 10/20
 - 34s - loss: 5.9987 - acc: 0.0126 - val_loss: 6.1245 - val_acc: 0.0079
Epoch 11/20
 - 34s - loss: 6.0243 - acc: 0.0101 - val_loss: 5.8847 - val_acc: 0.0132
Epoch 12/20
 - 34s - loss: 5.9545 - acc: 0.0118 - val_loss: 5.9234 - val_acc: 0.0105
Epoch 13/20
 - 34s - loss: 5.9134 - acc: 0.0128 - val_loss: 5.9101 - val_acc: 0.0137
Epoch 14/20
 - 34s - loss: 5.9274 - acc: 0.0132 - val_loss: 5.7018 - val_acc: 0.0122
Epoch 15/20
 - 34s - loss: 5.9087 - acc: 0.0129 - val_loss: 5.8049 - val_acc: 0.0139
Epoch 16/20
 - 34s - loss: 6.0090 - acc: 0.0103 - val_loss: 6.0212 - val_acc: 0.0088
Epoch 17/20
 - 34s - loss: 5.9659 - acc: 0.0100 - val_loss: 5.8214 - val_acc: 0.0122
Epoch 18/20
 - 34s - loss: 6.0334 - acc: 0.0089 - val_loss: 6.1594 - val_acc: 0.0068
Epoch 19/20
 - 34s - loss: 6.0724 - acc: 0.0081 - val_loss: 6.0742 - val_acc: 0.0102
Epoch 20/20
 - 34s - loss: 6.0380 - acc: 0.0087 - val_loss: 6.0270 - val_acc: 0.0077
training history:
{'val_loss': [5.479214868927002, 5.558000003051758, 5.62801993560791, 5.679891560363769, 5.767225489807129, 5.81142740020752, 5.871692316436768, 5.97958316192627, 5.809024047088623, 6.124514974975586, 5.884677487182617, 5.923381034851074, 5.91012718963623, 5.701794813537598, 5.804874476623535, 6.021242748260498, 5.821447930145264, 6.15941844329834, 6.074186566162109, 6.027012740325928], 'val_acc': [0.033, 0.0319, 0.0233, 0.0188, 0.0228, 0.0136, 0.0183, 0.0093, 0.0126, 0.0079, 0.0132, 0.0105, 0.0137, 0.0122, 0.0139, 0.0088, 0.0122, 0.0068, 0.0102, 0.0077], 'loss': [5.7534715600585935, 5.58111505279541, 5.67043945388794, 5.807204641418457, 5.851277138977051, 5.89936609375, 5.904497184448243, 5.928716643218994, 5.895865586090088, 5.998733691253662, 6.0244044747924805, 5.954422227020264, 5.913461318664551, 5.927423741760254, 5.9087016925048825, 6.009021345825195, 5.9659499533081055, 6.03345162109375, 6.072360605010986, 6.0379577728271485], 'acc': [0.02268, 0.03201, 0.02748, 0.02049, 0.01745, 0.01335, 0.01539, 0.01416, 0.01375, 0.01258, 0.01006, 0.01184, 0.01278, 0.01317, 0.01291, 0.01029, 0.00999, 0.0089, 0.00807, 0.00869]}
Training time: 
674.0555126667023
Evaluation results:  [6.027012752532959, 0.0077]

